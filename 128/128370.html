<html><title>Macro</title><body>&#10;<p> &#10; </p>&#10;<p>Uma <b>macro</b> (abrevia&ccedil;&atilde;o para <b>macroinstru&ccedil;&atilde;o</b>), em <a href="http://en.wikipedia.org/wiki/Ci%C3%AAncia_da_computa%C3%A7%C3%A3o" id="w">ci&ecirc;ncia da computa&ccedil;&atilde;o</a>, &eacute; uma regra ou <a href="http://en.wikipedia.org/wiki/Padr%C3%A3o" id="w">padr&atilde;o</a> que especifica como uma certa sequ&ecirc;ncia de entrada (frequentemente uma sequ&ecirc;ncia de <a href="http://en.wikipedia.org/wiki/Caractere" id="w">caracteres</a>) deve ser mapeada para uma substitui&ccedil;&atilde;o de sequ&ecirc;ncia de sa&iacute;da (tamb&eacute;m frequentemente uma sequ&ecirc;ncia de caracteres) de acordo com um procedimento definido. O processo de mapeamento que instancia (transforma) uma utiliza&ccedil;&atilde;o de macro em uma sequ&ecirc;ncia espec&iacute;fica &eacute; conhecido como <i>expans&atilde;o de macro</i>. O recurso de escrita de macros pode ser fornecido como parte de um <a href="http://en.wikipedia.org/wiki/Software_aplicativo" id="w">software aplicativo</a> ou como uma parte de uma <a href="http://en.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o" id="w">linguagem de programa&ccedil;&atilde;o</a>. No primeiro caso, as macros s&atilde;o usadas para realizar tarefas usando o aplicativo menos repetitivo. No outro caso, elas s&atilde;o uma ferramenta que permite um programador habilitar a <a href="http://en.wikipedia.org/wiki/Reutiliza%C3%A7%C3%A3o_de_c%C3%B3digo" id="w">reutiliza&ccedil;&atilde;o de c&oacute;digo</a> ou mesmo projetar <a href="http://en.wikipedia.org/wiki/Linguagem_de_dom%C3%ADnio_espec%C3%ADfico" id="w">linguagens de dom&iacute;nio espec&iacute;fico</a>.</p>&#10;<p>Existem tr&ecirc;s ramifica&ccedil;&otilde;es de macros, cada uma com diferentes padr&otilde;es de entrada e de sa&iacute;da:&#10;</p>&#10;<ul>&#10;<li><i>Macros de programa&ccedil;&atilde;o</i> possuem um <a href="http://en.wikipedia.org/wiki/Programa_de_computador" id="w">programa de computador</a> como entrada e retornam como sa&iacute;da um novo e expandido programa. Tal processo &eacute; chamado <i>expans&atilde;o por macros</i> e a ferramenta que faz isto &eacute; chamada de <i>macro&shy;expansor</i>, ou simplesmente <a href="http://en.wikipedia.org/wiki/Pr%C3%A9&shy;processador" id="w">pr&eacute;&shy;processador</a>. Para muitas <a href="http://en.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o" id="w">linguagens de programa&ccedil;&atilde;o</a> o macro&shy;expansor &eacute; inclu&iacute;do no <a href="http://en.wikipedia.org/wiki/Interpretador" id="w">interpretador</a> ou no <a href="http://en.wikipedia.org/wiki/Compilador" id="w">compilador</a>. Tais macros permitem a utiliza&ccedil;&atilde;o de abstra&ccedil;&otilde;es de alto n&iacute;vel nas linguagens de programa&ccedil;&atilde;o.</li>&#10;<li><i>Macros de teclado ou mouse</i> e <i>macros de aplica&ccedil;&atilde;o</i> possuem um <a href="http://en.wikipedia.org/wiki/Comando" id="w">comando</a> como entrada e retornam como sa&iacute;da um novo e expandido conjunto de comandos ou instru&ccedil;&otilde;es. Tais macros s&atilde;o tipicamente usadas para <a href="http://en.wikipedia.org/wiki/Automa%C3%A7%C3%A3o" id="w">automatizar</a> sequ&ecirc;ncias de instru&ccedil;&otilde;es, movimentos ou regras frequentemente usadas.</li></ul>&#10;<a id="Macros_de_teclado_ou_mouse" name="Macros_de_teclado_ou_mouse"></a><h2> Macros de teclado ou mouse </h2>&#10;<p>Macros de <a href="http://en.wikipedia.org/wiki/Teclado_(computador)" id="w">teclado</a> ou <a href="http://en.wikipedia.org/wiki/Mouse" id="w">mouse</a> permitem que sequ&ecirc;ncias curtas de teclas pressionadas ou a&ccedil;&otilde;es do mouse substituam longas sequ&ecirc;ncias de comandos, automatizando tarefas repetitivas. Da mesma forma que macros de aplica&ccedil;&atilde;o, estas macros podem ser definidas tanto por grava&ccedil;&atilde;o ou por linguagem de programa&ccedil;&atilde;o de macros.</p>&#10;<a id="Macros_de_aplica%C3%A7%C3%A3o_e_script" name="Macros_de_aplica%C3%A7%C3%A3o_e_script"></a><h3> Macros de aplica&ccedil;&atilde;o e script </h3>&#10;<p><a href="http://en.wikipedia.org/wiki/Aplica%C3%A7%C3%A3o" id="w">Aplica&ccedil;&otilde;es</a> podem usar sistemas an&aacute;logos de macros, que permitem ao usu&aacute;rio especificar uma s&eacute;rie de a&ccedil;&otilde;es em um novo procedimento. As macros s&atilde;o geralmente gravadas ao executar a sequ&ecirc;ncia uma vez, permitindo &agrave; aplica&ccedil;&atilde;o lembrar de tais a&ccedil;&otilde;es. Usu&aacute;rios avan&ccedil;ados podem tamb&eacute;m fazer uso de uma linguagem de programa&ccedil;&atilde;o de macros embutida, que possui acesso direto &agrave;s funcionalidades da aplica&ccedil;&atilde;o.</p>&#10;<p>Uma linguagem de macro &eacute; uma <a href="http://en.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o" id="w">linguagem de programa&ccedil;&atilde;o</a> na qual toda a computa&ccedil;&atilde;o &eacute; feita pela expans&atilde;o (instancia&ccedil;&atilde;o) de macros. Geralmente, n&atilde;o s&atilde;o usadas para a programa&ccedil;&atilde;o geral, mas s&atilde;o comuns em aplica&ccedil;&otilde;es de processamento de texto.</p>&#10;<p><a href="http://en.wikipedia.org/wiki/Visual_Basic_for_Applications" id="w">Visual Basic for Applications</a> (VBA) &eacute; uma <a href="http://en.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o" id="w">linguagem de programa&ccedil;&atilde;o</a> inclu&iacute;da no <a href="http://en.wikipedia.org/wiki/Microsoft_Office" id="w">Microsoft Office</a> e algumas outras aplica&ccedil;&otilde;es. Ela n&atilde;o &eacute; uma linguagem de macros, mas suas funcionalidades evolu&iacute;ram e ela acabou substituindo as linguagens de macro anteriores de tais aplica&ccedil;&otilde;es, sendo atualmente chamada incorretamente de linguagem de macro.</p>&#10;<a id="V%C3%ADrus_de_macro" name="V%C3%ADrus_de_macro"></a><h4> V&iacute;rus de macro </h4>&#10;<p> &#10;O VBA possui acesso &agrave; maioria das fun&ccedil;&otilde;es do <a href="http://en.wikipedia.org/wiki/Sistema_operacional" id="w">sistema operacional</a> e suporta execu&ccedil;&atilde;o autom&aacute;tica de c&oacute;digo quando um documento &eacute; aberto. Tal arquitetura torna relativamente simples a constru&ccedil;&atilde;o de <a href="http://en.wikipedia.org/wiki/V%C3%ADrus_inform%C3%A1tico" id="w">v&iacute;rus inform&aacute;ticos</a>, conhecidos popularmente como <a href="http://en.wikipedia.org/wiki/V%C3%ADrus_de_macro" id="w">v&iacute;rus de macro</a>.</p>&#10;<a id="Ramifica%C3%A7%C3%B5es" name="Ramifica%C3%A7%C3%B5es"></a><h2> Ramifica&ccedil;&otilde;es </h2>&#10;<a id="Macros_de_programa%C3%A7%C3%A3o" name="Macros_de_programa%C3%A7%C3%A3o"></a><h3> Macros de programa&ccedil;&atilde;o </h3>&#10;<p>Linguagens como <a href="http://en.wikipedia.org/wiki/Linguagem_de_programa%C3%A7%C3%A3o_C" id="w">C</a> e <a href="http://en.wikipedia.org/wiki/Assembly" id="w">assembly</a> possuem sistemas simples de macros, implementados como <a href="http://en.wikipedia.org/wiki/Pr%C3%A9&shy;processador" id="w">pr&eacute;&shy;processadores</a> no <a href="http://en.wikipedia.org/wiki/Compilador" id="w">compilador</a> ou <a href="http://en.wikipedia.org/wiki/Montador" id="w">montador</a>, respectivamente. No caso do C, as macros funcionam pela simples busca e substitui&ccedil;&atilde;o textual pelo <a href="http://en.wikipedia.org/wiki/C%C3%B3digo_fonte" id="w">c&oacute;digo fonte</a>.</p>&#10;<p>Dialetos da linguagem <a href="http://en.wikipedia.org/wiki/Lisp" id="w">Lisp</a>, tais como o <a href="http://en.wikipedia.org/wiki/Common_Lisp" id="w">Common Lisp</a> e <a href="http://en.wikipedia.org/wiki/Scheme" id="w">Scheme</a>, possuem sistemas mais elaborados de macros: em Lisp as macros agem como fun&ccedil;&otilde;es que transformam o texto do programa, com toda a linguagem dispon&iacute;vel para expressar tais transforma&ccedil;&otilde;es. Em contraste com as macros do C, que definem simples substitui&ccedil;&otilde;es de uma sintaxe para outra, uma macro do Lisp pode controlar o processamento de se&ccedil;&otilde;es do c&oacute;digo e do fluxo do <a href="http://en.wikipedia.org/wiki/Algoritmo" id="w">algoritmo</a>.</p>&#10;<a id="Principais_macros_para_Office" name="Principais_macros_para_Office"></a><h4> Principais macros para Office </h4>&#10;<p>O <a href="http://en.wikipedia.org/wiki/Microsoft_Office" id="w">Microsoft Office</a> mant&eacute;m diversas instru&ccedil;&otilde;es macros gravadas em seu interior. Estas instru&ccedil;&otilde;es s&atilde;o padr&atilde;o entre os diversos aplicativos do pacote. Atalhos s&atilde;o definidos e est&atilde;o dispon&iacute;veis para todos os usu&aacute;rios.&#10;</p>&#10;<ul>&#10;<li>Ctrl + P = imprimir&semi; arquivo</li>&#10;<li>Ctrl + T = selecionar&semi; tudo</li>&#10;<li>Ctrl + B = salvar</li>&#10;<li>Ctrl + N = negrito</li>&#10;<li>Ctrl + I = it&aacute;lico</li>&#10;<li>Ctrl + S = sublinhado</li>&#10;<li>Ctrl + C = copiar</li>&#10;<li>Ctrl + V = colar</li></ul>&#10;<p>Al&eacute;m disso, podemos gravar novas instru&ccedil;&otilde;es e usar os atalhos dispon&iacute;veis, criar um bot&atilde;o ou acess&aacute;&shy;las usando Alt+F8 no teclado.</p>&#10;<p>Usando macros, &eacute; poss&iacute;vel, por exemplo, imprimir arquivo de &uacute;nica p&aacute;gina v&aacute;rias vezes com n&uacute;meros diferentes a cada impress&atilde;o, colar especial valores dentro do <a href="http://en.wikipedia.org/wiki/Microsoft_Excel" id="w">Excel</a> sem repetir esta opera&ccedil;&atilde;o diversas vezes, estas a&ccedil;&otilde;es permitem que os usu&aacute;rios trabalhem com maior facilidade.</p>&#10;<p>Para construir uma macro dentro do Office basta acessar o <a href="http://en.wikipedia.org/wiki/Menu" id="w">Menu</a> Ferramentas, Macros, clicar em Gravar Nova Macro e realizar a sequ&ecirc;ncia desejada. Esta instru&ccedil;&atilde;o estar&aacute; dispon&iacute;vel na pasta de trabalho que for gravada. Para usar estas instru&ccedil;&otilde;es macros em todas as pastas de trabalho grave&shy;as na pasta pessoal de macros.</p>&#10;<p>Por seguran&ccedil;a, n&atilde;o execute macros em seu computador de pessoas desconhecidas ou de fontes duvidosas, &eacute; f&aacute;cil produzir estas macros, assim pe&ccedil;a explica&ccedil;&otilde;es nos foruns da <a href="http://en.wikipedia.org/wiki/Internet" id="w">Internet</a> e lembre&shy;se sempre de entender o que um determinado comando far&aacute; no computador mantendo o n&iacute;vel de seguran&ccedil;a das macros do Office como m&eacute;dio.</p>&#10;<a id="Exemplo_de_Macro_para_Excel" name="Exemplo_de_Macro_para_Excel"></a><h4> Exemplo de Macro para Excel </h4>&#10;<p>Vamos agora criar uma macro para que ao se digitar na coluna A do Excel o computador mostre a data e hora que este determinado texto foi digitado. Observe que o VBA &eacute; orientado a eventos, ou seja quando ocorrer uma determinada a&ccedil;&atilde;o o aplicativo responder&aacute; executando as linhas de c&oacute;digo definidas pelo desenvolvedor, neste caso usaremos o comando Change (ao digitar) da planilha.&#10;   &#39&semi;Defini&ccedil;&atilde;o das instru&ccedil;&otilde;es, nome do procedimento&#10;   Private Sub Worksheet_Change(ByVal Target As Range)&#10;     &#39&semi;Operador de condi&ccedil;&atilde;o, realiza quando verdade&#10;     If Target.Column = 1 Then&#10;        &#39&semi;Inserindo data e hora na coluna B do planilha na linha referente da coluna A&#10;        Cells(Target.Row, 2).Value = FormatDateTime((Str(Now)), vbGeneralDate)&#10;     &#39&semi;Fim da opera&ccedil;&atilde;o de condi&ccedil;&atilde;o&#10;     End If&#10;   &#39&semi;Fim do procedimento&#10;   End Sub&#10;Esta &eacute; uma execu&ccedil;&atilde;o simples, por&eacute;m auxilia no cadastro de entradas e sa&iacute;das das pessoas de um determinado local, registro de monitoramento de processos, previs&atilde;o e chegada de encomendas confrontando com a hora real de chegada, diminuindo a necessidade de digita&ccedil;&atilde;o de datas e horas pelo operador da planilha, al&eacute;m de ser mais seguro desde que a data e hora do sistema esteja correta.</p>&#10;<p>Outra forma de automatizar os trabalhos e minimizar a necessidade de f&oacute;rmulas enormes que s&atilde;o copiadas entre muitas planilhas, &eacute; a constru&ccedil;&atilde;o de fun&ccedil;&otilde;es <i>Functions</i> dentro de um m&oacute;dulo macro do Excel.</p>&#10;<p>Estas fun&ccedil;&otilde;es poder&atilde;o ser solicitadas dentro do m&oacute;dulo onde foram criadas ou tamb&eacute;m pode&shy;se grav&aacute;&shy;las dentro da Pasta Pessoal de Macros e serem usadas por todas as planilhas abertas. Segundo o <i>Help</i> do <i><a href="http://en.wikipedia.org/wiki/Visual_Basic" id="w">Visual Basic</a></i>, a fun&ccedil;&atilde;o necessita do m&oacute;dulo para executar e as macros dever&atilde;o estar habilitadas, pois, do contr&aacute;rio n&atilde;o funcionar&atilde;o. Ent&atilde;o, caso mude de computador leve junto a pasta onde est&atilde;o armazenadas suas fun&ccedil;&otilde;es e fa&ccedil;a rotineiramente c&oacute;pias de seguran&ccedil;a e guarde&shy;as em local seguro.</p>&#10;<p>A fun&ccedil;&atilde;o abaixo pode ser utilizada para contar quantas vezes ocorre um determinado dia da semana num intervalo de tempo, retornando um n&uacute;mero inteiro. A utiliza&ccedil;&atilde;o desta fun&ccedil;&atilde;o poder&aacute; ser feita por qualquer vers&atilde;o do <a href="http://en.wikipedia.org/wiki/Microsoft_Excel" id="w">Microsoft Excel</a>, assim, abra a pasta de trabalho onde deseja inserir a fun&ccedil;&atilde;o, v&aacute; na barra de ferramenta <i>Visual Basic</i>, insira um m&oacute;dulo e edite a fun&ccedil;&atilde;o abaixo:</p>&#10;<pre>   Function ContaDiaSemana(DataInicial As Date, Datafinal As Date, DiaProcurado As Integer)&#10;   Dim DataIni As Date&#10;   Dim ContaDia As Integer&#10;   ContaDia = 0&#10;      For DataIni = DataInicial To Datafinal&#10;         If Weekday(DataIni) = DiaProcurado Then&#10;            ContaDia = ContaDia + 1&#10;    </pre>&#10;<p>A partir deste ponto, a fun&ccedil;&atilde;o poder&aacute; ser executada como uma fun&ccedil;&atilde;o normal do Excel e estar&aacute; dispon&iacute;vel no menu Inserir Fun&ccedil;&atilde;o na categoria Todas. Para us&aacute;&shy;la dever&aacute; considerar a <a href="http://en.wikipedia.org/wiki/Vari%C3%A1vel" id="w">vari&aacute;vel</a> DataInicial como uma data v&aacute;lida, DataFinal tamb&eacute;m como uma data v&aacute;lida, por&eacute;m maior que DataInicial e DiaProcurado um n&uacute;mero inteiro maior ou igual a um (1) e menor ou igual a sete (7), onde 1 = domingo, 2 = segunda&shy;feira, 3 = ter&ccedil;a&shy;feira... 7 = s&aacute;bado.</p>&#10;<p>Exemplo:&#10;Uma empresa de eventos far&aacute; seu or&ccedil;amento anual, que ter&aacute; in&iacute;cio no primeiro dia de 2008 e encerrar&aacute; obviamente no &uacute;ltimo dia do mesmo ano, sabe&shy;se que seus proventos s&atilde;o calculados sobre os s&aacute;bados, assim &eacute; necess&aacute;rio saber quantos s&aacute;bados h&aacute; no referido intervalo. Assim, usando uma planilha do Excel, pode&shy;se definir os seguintes valores nas c&eacute;lulas:&#10;</p>&#10;<ul>&#10;<li>A1 = 01/01/2008 data inicial do per&iacute;odo&semi;</li>&#10;<li>A2 = 31/12/2008 data final do per&iacute;odo, repare que esta data &eacute; maior que a anterior&semi;</li>&#10;<li>A3 = 7 n&uacute;mero que representa o s&aacute;bado, dia da semana procurado&semi;</li></ul>&#10;<p>A fun&ccedil;&atilde;o usada para calcular este problema ser&aacute; editada na c&eacute;lula A4, a qual receber&aacute; a contagem do dia definido, sendo:</p>&#10;<p>= ContaDiaSemana(A1, A2, A3), que retornar&aacute; um n&uacute;mero inteiro igual a cinquenta e dois (52) que &eacute; a quantidade de s&aacute;bados do ano de 2008.</p>&#10;<p>Para somar mais de um dia pode&shy;se usar tamb&eacute;m:</p>&#10;<p>= ContaDiaSemana(A1, A2, 7)+ContaDiaSemana(A1, A2, 1), o resultado ser&aacute; a soma dos s&aacute;bados e domingos do intervalo.</p>&#10;<p>Como no exemplo citado acima, &eacute; poss&iacute;vel tamb&eacute;m criar outras fun&ccedil;&otilde;es, bastando para isso um bom problema e alguns neur&oacute;nios dispon&iacute;veis.</p>&#10;<a id="Exemplo_de_Macro_em_C" name="Exemplo_de_Macro_em_C"></a><h4> Exemplo de Macro em C </h4>&#10;<p>Como exemplo, vamos usar o #define. Esse &eacute; um preprocessado em C, em que se tem a estrutura: <i>#define nome texto_de_substitui&ccedil;&atilde;o.</i>&#10;Outro exemplo &eacute; o #include, no qual se declara a biblioteca em que se buscam as fun&ccedil;&otilde;es fora da linguagem padr&atilde;o do C. A stdio.h &eacute; uma biblioteca n&atilde;o padr&atilde;o do C, na qual se tem a famosa fun&ccedil;&atilde;o printf, uma chamada de sistema para impress&atilde;o na tela.</p>&#10;<p>Bom, vamos ao exemplo.</p>&#10;&#10;<ul>&#10;<li><i>#define infinito for(&semi;&semi;)   &rarr; aqui todas as palavras infinito do c&oacute;digo ser&atilde;o substituidas por for(&semi;&semi;)</i></li></ul>&#10;<a id="%7B%7BVer_tamb%C3%A9m%7D%7D" name="%7B%7BVer_tamb%C3%A9m%7D%7D"></a><h2>   </h2>&#10;&#10;<ul>&#10;<li><a href="http://en.wikipedia.org/wiki/Pr%C3%A9&shy;processador" id="w">Pr&eacute;&shy;processador</a></li></ul>&#10;<p>Exemplos de macros no Excel 2007 &shy; <a class="externallink" href="http://www.saberexcel.com/download_free_rel.htm" rel="nofollow" title="http://www.saberexcel.com/download_free_rel.htm">http://www.saberexcel.com/download_free_rel.htm</a></p>&#10;<p><a href="http://en.wikipedia.org/wiki/Categoria:Programa%C3%A7%C3%A3o" id="w">Categoria:Programa&ccedil;&atilde;o</a></p></body></html>