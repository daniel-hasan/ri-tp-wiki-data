<html><title>Insertion sort</title><body>&#10;<p> &#10;<a href="http://en.wikipedia.org/wiki/Ficheiro:Insertion_sort_animation.gif%7Cframe%7Cright" id="w">Exemplo de funcionamento do insertion sort em uma lista de inteiros aleat&oacute;rios</a>&#10;<a href="http://en.wikipedia.org/wiki/File:Insertion&shy;sort&shy;example&shy;300px.gif%7Cthumb" id="w">Insertion&shy;sort&shy;example&shy;300px</a>&#10;<b>Insertion sort</b>, ou <i>ordena&ccedil;&atilde;o por inser&ccedil;&atilde;o</i>, &eacute; um simples <a href="http://en.wikipedia.org/wiki/Algoritmo_de_ordena%C3%A7%C3%A3o" id="w">algoritmo de ordena&ccedil;&atilde;o</a>, eficiente quando aplicado a um pequeno n&uacute;mero de elementos. Em termos gerais, ele percorre um vetor de elementos da esquerda para a direita e &agrave; medida que avan&ccedil;a vai deixando os elementos mais &agrave; esquerda ordenados. O algoritmo de inser&ccedil;&atilde;o funciona da mesma maneira com que muitas pessoas ordenam cartas em um jogo de baralho como o p&ocirc;quer.<sup id="_ref&shy;1" class="reference"><a href="#_note&shy;1" title="">[1]</a></sup></p>&#10;<a id="Caracter%C3%ADsticas" name="Caracter%C3%ADsticas"></a><h2>Caracter&iacute;sticas</h2>&#10;&#10;<ul>&#10;<li>Menor n&uacute;mero de trocas e compara&ccedil;&otilde;es entre os algoritmos de ordena&ccedil;&atilde;o O(n) quando o vetor est&aacute; ordenado.</li>&#10;<li>Pior caso O(n&sup2;)</li></ul>&#10;<a id="Implementa%C3%A7%C3%B5es" name="Implementa%C3%A7%C3%B5es"></a><h2>Implementa&ccedil;&otilde;es</h2>&#10;<a id="%5B%5BPseudoc%C3%B3digo%5D%5D" name="%5B%5BPseudoc%C3%B3digo%5D%5D"></a><h3>[[Pseudoc&oacute;digo]]</h3>&#10;<p>Segue uma vers&atilde;o simples do pseudoc&oacute;digo do algoritmo, com vetores come&ccedil;ando em zero:&#10;</p>&#10;<pre>&#10;FUN&Ccedil;&Atilde;O INSERTION_SORT (A[], tamanho)&#10;        VARI&Aacute;VEIS      &#10;                i, ,j&#10;                eleito&#10;        PARA I &#60&semi;&shy; 1 AT&Eacute; tamanho FA&Ccedil;A&#10;                eleito &#60&semi;&shy; A[i]&semi;&#10;                j &#60&semi;&shy; i&shy;1&semi;&#10;                ENQUANTO ((j&#62&semi;=0) E (eleito &#60&semi; A[j])) FA&Ccedil;A&#10;                          A[j+1]:= A[j]&semi;&#10;                          j:=j&shy;1&semi;&#10;                FIM_ENQUANTO&#10;                A[j+1] &#60&semi;&shy; eleito&semi;                &#10;        FIM_PARA&#10;FIM&#10;</pre>&#10;&#10;<a id="%5B%5BPseudoc%C3%B3digo_2%5D%5D" name="%5B%5BPseudoc%C3%B3digo_2%5D%5D"></a><h3>[[Pseudoc&oacute;digo 2]]</h3>&#10;<p>Nessa vers&atilde;o &eacute; acrescentada uma verifica&ccedil;&atilde;o para saber se precisa &#34&semi;inserir&#34&semi; o &#34&semi;eleito&#34&semi; na sua nova posi&ccedil;&atilde;o, ou seja, se n&atilde;o houve trocas, n&atilde;o precisa reescrever o valor, j&aacute; que ele j&aacute; estar&aacute; no lugar certo.&#10;</p>&#10;<pre>&#10;FUN&Ccedil;&Atilde;O INSERTION_SORT (A[], tamanho)&#10;        VARI&Aacute;VEIS      &#10;                i, ,j&#10;                eleito&#10;        PARA I &#60&semi;&shy; 1 AT&Eacute; tamanho&shy;1 FA&Ccedil;A&#10;                eleito &#60&semi;&shy; A[i]&semi;&#10;                j &#60&semi;&shy; i&shy;1&semi;&#10;                ENQUANTO ((j&#62&semi;=0) E (eleito &#60&semi; A[j])) FA&Ccedil;A&#10;                          A[j+1]:=v[j]&semi;&#10;                          j:=j&shy;1&semi;&#10;                FIM_ENQUANTO&#10;                SE ((j) &#60&semi;&#62&semi; (i&shy;1) ENT&Atilde;O  //se for diferente teve troca de posi&ccedil;&otilde;es anteriormente&#10;                         A[j+1] &#60&semi;&shy; eleito&semi; //escreve na nova posi&ccedil;&atilde;o&#10;        FIM_PARA&#10;FIM&#10;</pre>&#10;&#10;<a id="%5B%5BxHarbour%5D%5D" name="%5B%5BxHarbour%5D%5D"></a><h3>[[xHarbour]]</h3>&#10;<p />&#10;<pre>&#10;Function SortInsertion( aList )&#10;   Local nLoop1 := 0&#10;   Local nLoop2 := 0&#10;   Local nIndex := 0&#10;   For nLoop1 := 1 To Len( aList )&#10;       nLoop2 := nLoop1&#10;       nIndex := aList[ nLoop1 ]&#10;       While nLoop2 &#62&semi; 1 .And. aList[ nLoop2 &shy; 1 ] &#62&semi; nIndex&#10;          aList[ nLoop2 ] := aList[ nLoop2 &shy; 1 ]&#10;          nLoop2 &shy;&shy;&#10;       EndDo&#10;       aList[ nLoop2 ] := nIndex&#10;   Next&#10;Return NIL&#10;</pre>&#10;&#10;&#10;<a id="%5B%5BJava%5D%5D" name="%5B%5BJava%5D%5D"></a><h3>[[Java]]</h3>&#10;&#10;<p /><pre class="code">&#10;<b><font color="#7F0055">public</font></b> Long[] ordenarCrescente(Long[] array) {&#10;    <b><font color="#7F0055">for</font></b>(<b><font color="#7F0055">int</font></b> fixo = 1&semi; fixo &#60&semi; array.length&semi; fixo++) {&#10;        <b><font color="#7F0055">for</font></b> (<b><font color="#7F0055">int</font></b> <b><font color="#7F0055">var</font></b> = fixo&semi; <b><font color="#7F0055">var</font></b> &#62&semi;= 1 &#38&semi;&#38&semi; array[<b><font color="#7F0055">var</font></b>] &#60&semi; array[<b><font color="#7F0055">var</font></b> &shy; 1]&semi; <b><font color="#7F0055">var</font></b>&shy;&shy;) {&#10;            <font color="#3F7F5F">// Troca os elementos&#10;</font>            array[<b><font color="#7F0055">var</font></b>] += array[<b><font color="#7F0055">var</font></b> &shy; 1]&semi;&#10;&#9;    array[<b><font color="#7F0055">var</font></b> &shy; 1] = array[<b><font color="#7F0055">var</font></b>] &shy; array[<b><font color="#7F0055">var</font></b> &shy; 1]&semi;&#10;&#9;    array[<b><font color="#7F0055">var</font></b>] &shy;= array[<b><font color="#7F0055">var</font></b> &shy; 1]&semi;&#10;        }&#10;    }&#10;    <b><font color="#7F0055">return</font></b> array&semi;&#10;}&#10;</pre>&#10;&#10;<a id="%5B%5BVisual_Basic%5D%5D" name="%5B%5BVisual_Basic%5D%5D"></a><h3>[[Visual Basic]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BLinguagem_de_programa%C3%A7%C3%A3o_C%7CC%5D%5D" name="%5B%5BLinguagem_de_programa%C3%A7%C3%A3o_C%7CC%5D%5D"></a><h3>[[Linguagem de programa&ccedil;&atilde;o C|C]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BPascal%5D%5D" name="%5B%5BPascal%5D%5D"></a><h3>[[Pascal]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BRuby_(linguagem_de_programa%C3%A7%C3%A3o)%7CRuby%5D%5D" name="%5B%5BRuby_(linguagem_de_programa%C3%A7%C3%A3o)%7CRuby%5D%5D"></a><h3> [[Ruby (linguagem de programa&ccedil;&atilde;o)|Ruby]] </h3>&#10;<p />&#10;&#10;<a id="%5B%5BPython%5D%5D" name="%5B%5BPython%5D%5D"></a><h3>[[Python]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BHaskell%5D%5D" name="%5B%5BHaskell%5D%5D"></a><h3>[[Haskell]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BC%23%5D%5D" name="%5B%5BC%23%5D%5D"></a><h3>[[C#]]</h3>&#10;<p /><pre class="code">&#10;<b><font color="#7F0055">static</font></b> int[] insertionSort(int[] A) { &#10;   int i, j, eleito&semi;&#10;   <b><font color="#7F0055">for</font></b> (i = 1&semi; i &#60&semi; A.Length&semi; i++) {&#10;       eleito = A[i]&semi;&#10;       j = i&semi;&#10;       <b><font color="#7F0055">while</font></b> ((j &#62&semi; 0) &#38&semi;&#38&semi; (A[j &shy;1] &#62&semi; eleito)) {&#10;           A[j] = A[j &shy;1]&semi;&#10;           j = j &shy; 1&semi;&#10;       }&#10;       A[j] = eleito&semi;&#10;   }&#10;   <b><font color="#7F0055">return</font></b> A&semi;&#10;}&#10;</pre>&#10;&#10;<a id="%5B%5BPHP%5D%5D" name="%5B%5BPHP%5D%5D"></a><h3>[[PHP]]</h3>&#10;<p /><pre class="code">&#10;ini_set(<font color="#2A00FF">&#39&semi;max_execution_time&#39&semi;</font>,<font color="#2A00FF">&#39&semi;600&#39&semi;</font>)&semi;&#10;&#10;<b><font color="#7F0055">function</font></b> microtime_float()&#10;{&#10;    <b><font color="#7F0055">list</font></b>($usec, $sec) = explode(<font color="#2A00FF">&#34&semi; &#34&semi;</font>, microtime())&semi;&#10;    <b><font color="#7F0055">return</font></b> ((float)$usec + (float)$sec)&semi;&#10;}&#10;&#10;&#10;<b><font color="#7F0055">for</font></b> ($gera = 0&semi; $gera &#60&semi;=20000&semi; $gera++){&#10;&#9;$<b><font color="#7F0055">array</font></b>[$gera] = rand(0, 10000)&semi;&#10;}&#10;&#10;$time_start = microtime_float()&semi;&#10;<b><font color="#7F0055">for</font></b>($i = 1&semi; $i &#60&semi; count($<b><font color="#7F0055">array</font></b>)&semi; $i++){&#10;&#9;$copiado = $<b><font color="#7F0055">array</font></b>[$i]&semi;&#10;&#9;$j = $i&semi;&#10;&#9;&#9;<b><font color="#7F0055">while</font></b> (($j &#62&semi; 0 ) &#38&semi;&#38&semi; ($copiado &#60&semi; $<b><font color="#7F0055">array</font></b>[$j&shy;1])){&#10;&#9;&#9;&#9;$<b><font color="#7F0055">array</font></b>[$j] = $<b><font color="#7F0055">array</font></b>[$j&shy;1]&semi;&#10;&#9;&#9;&#9;$j&shy;&shy;&semi;&#10;&#9;&#9;}&#10;&#9;&#9;$<b><font color="#7F0055">array</font></b>[$j] = $copiado&semi;&#9;&#10;}&#10;$time_end = microtime_float()&semi;&#10;<font color="#3F7F5F">//Mostra o tempo que levou para ordenar&#10;</font><b><font color="#7F0055">echo</font></b> $time = $time_end &shy; $time_start&semi;&#10;&#10;<font color="#3F7F5F">//Exibe a ordena&ccedil;&atilde;o&#10;</font>print_r ($<b><font color="#7F0055">array</font></b>)&semi;&#10;</pre>&#10;<p>source</p>&#10;<a id="%5B%5BC%2B%2B%5D%5D" name="%5B%5BC%2B%2B%5D%5D"></a><h3>[[C++]]</h3>&#10;<p />&#10;&#10;<a id="%5B%5BR_(linguagem_de_programa%C3%A7%C3%A3o)%7CR%5D%5D" name="%5B%5BR_(linguagem_de_programa%C3%A7%C3%A3o)%7CR%5D%5D"></a><h3> [[R (linguagem de programa&ccedil;&atilde;o)|R]] </h3>&#10;&#10;<p />&#10;<pre>&#10;insertSort &#60&semi;&shy; function(vec) {&#10;  for(i in 1:length(vec)) {&#10;    key &#60&semi;&shy; vec[i]&#10;    j &#60&semi;&shy; i&#10;    while(j &#62&semi; 1 && vec[j &shy; 1] &#62&semi; key) {&#10;      vec[j] &#60&semi;&shy; vec[j &shy; 1]&#10;      j &#60&semi;&shy; j &shy; 1&#10;    }&#10;    vec[j] &#60&semi;&shy; key&#10;  }&#10;  return(vec)&#10;}&#10;</pre>&#10;&#10;<a id="%5B%5BLua_(linguagem_de_programa%C3%A7%C3%A3o)%7CLua%5D%5D" name="%5B%5BLua_(linguagem_de_programa%C3%A7%C3%A3o)%7CLua%5D%5D"></a><h3> [[Lua_(linguagem_de_programa&ccedil;&atilde;o)|Lua]] </h3>&#10;<p />&#10;&#10;<a id="Simulador_Online" name="Simulador_Online"></a><h2>Simulador Online</h2>&#10;<p>Para um melhor entendimento, recomendo utilizarem o <a class="externallink" href="http://wikipedia.artudi.org/Insertion%20Sort.php" rel="nofollow" title="http://wikipedia.artudi.org/Insertion%20Sort.php">Simulador Online</a> para visualizarem exemplos de ordena&ccedil;&atilde;o de n&uacute;meros aleat&oacute;rios pelo Insertion Sort.</p>&#10;<a id="%7B%7BVer_tamb%C3%A9m%7D%7D" name="%7B%7BVer_tamb%C3%A9m%7D%7D"></a><h2> </h2>&#10;&#10;<ul>&#10;<li><a href="http://en.wikipedia.org/wiki/Selection_sort" id="w">Selection sort</a></li>&#10;<li><a href="http://en.wikipedia.org/wiki/Bubble_sort" id="w">Bubble sort</a></li></ul>&#10;<p> </p>&#10;<a id="Refer%C3%AAncias" name="Refer%C3%AAncias"></a><h2>Refer&ecirc;ncias</h2>&#10;&#10;<ul>&#10;<li><a href="http://en.wikipedia.org/wiki/Donald_Knuth" id="w">Donald Knuth</a>. <i>The Art of Computer Programming</i>, Volume 3: <i>Sorting and Searching</i>, Third Edition. Addison&shy;Wesley, 1997. <a class="external text" href="http://www.amazon.com/exec/obidos/ASIN/0201896850" rel="nofollow" title="http://www.amazon.com/exec/obidos/ASIN/0201896850">ISBN 0&shy;201&shy;89685&shy;0</a>. Section 5.2.1: Sorting by Insertion, pp.&#160&semi;80&ndash;105.</li>&#10;<li><a href="http://en.wikipedia.org/wiki/Thomas_H._Cormen" id="w">Thomas H. Cormen</a>, <a href="http://en.wikipedia.org/wiki/Charles_E._Leiserson" id="w">Charles E. Leiserson</a>, <a href="http://en.wikipedia.org/wiki/Ronald_L._Rivest" id="w">Ronald L. Rivest</a>, and <a href="http://en.wikipedia.org/wiki/Clifford_Stein" id="w">Clifford Stein</a>. <i><a href="http://en.wikipedia.org/wiki/Introduction_to_Algorithms" id="w">Introduction to Algorithms</a></i>, Second Edition. MIT Press and McGraw&shy;Hill, 2001. <a class="external text" href="http://www.amazon.com/exec/obidos/ASIN/0262032937" rel="nofollow" title="http://www.amazon.com/exec/obidos/ASIN/0262032937">ISBN 0262032937</a>. Section 2.1: Insertion sort, pp.&#160&semi;15&ndash;21.</li></ul>&#10;<a id="%7B%7BLiga%C3%A7%C3%B5es_externas%7D%7D" name="%7B%7BLiga%C3%A7%C3%B5es_externas%7D%7D"></a><h2> </h2>&#10;&#10;<ul>&#10;<li><a class="externallink" href="http://web.engr.oregonstate.edu/~minoura/cs162/javaProgs/sort/InsertSort.html" rel="nofollow" title="http://web.engr.oregonstate.edu/~minoura/cs162/javaProgs/sort/InsertSort.html">Uma anima&ccedil;&atilde;o em Java mostrando passo&shy;a&shy;passo a implementa&ccedil;&atilde;o do insertion sort.</a> (Offline)</li></ul>&#10;<p><a href="http://en.wikipedia.org/wiki/Categoria:Algoritmos_de_ordena%C3%A7%C3%A3o" id="w">Categoria:Algoritmos de ordena&ccedil;&atilde;o</a>&#10;<a href="http://no.wikipedia.org/wiki/Sorteringsalgoritme">no:Sorteringsalgoritme</a></p></body></html>