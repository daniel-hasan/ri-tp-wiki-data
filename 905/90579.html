<html><title>Java Card</title><body>&#10;<p><b>Java Card</b> &eacute; uma tecnologia que permite que pequenos <a href="http://en.wikipedia.org/wiki/Aplicativo" id="w">aplicativos</a> (<i><a href="http://en.wikipedia.org/wiki/Applet" id="w">applets</a></i>) baseados em <a href="http://en.wikipedia.org/wiki/Plataforma_Java" id="w">plataforma Java</a> sejam executados com seguran&ccedil;a em <i><a href="http://en.wikipedia.org/wiki/Smart_card" id="w">smart cards</a></i> e dispositivos similares com limita&ccedil;&otilde;es de processamento e armazenamento, como o <i>Java Ring</i>.</p>&#10;<p>O Java Card &eacute; amplamente utilizado em cart&otilde;es <a href="http://en.wikipedia.org/wiki/SIM" id="w">SIM</a> (usados em <a href="http://en.wikipedia.org/wiki/Telem%C3%B3vel" id="w">celulares</a> <a href="http://en.wikipedia.org/wiki/GSM" id="w">GSM</a>) e em cart&otilde;es para <a href="http://en.wikipedia.org/wiki/Caixa_eletr%C3%B4nico" id="w">caixas eletr&ocirc;nicos</a>. O primeiro Java Card foi apresentado em <a href="http://en.wikipedia.org/wiki/1997" id="w">1997</a> por v&aacute;rias empresas, incluindo uma divis&atilde;o da extinta <i>Schlumberger Limited</i> (divididas em <i>Axalto</i> e <i>Gemplus</i>, que terminaram por se <a class="externallink" href="http://www.gemalto.com" rel="nofollow" title="http://www.gemalto.com">fundir</a>).</p>&#10;<p>Os produtos Java Card s&atilde;o baseados nas especifica&ccedil;&otilde;es da Plataforma Java Card desenvolvidas pela <a href="http://en.wikipedia.org/wiki/Sun_Microsystems" id="w">Sun Microsystems</a>, e suas principais caracter&iacute;sticas s&atilde;o <i>portabilidade</i> e <i>seguran&ccedil;a</i>.</p>&#10;<a id="Principais_caracter%C3%ADsticas" name="Principais_caracter%C3%ADsticas"></a><h2>Principais caracter&iacute;sticas</h2>&#10;&#10;<ul>&#10;<li>Interoperabilidade: escreva uma vez e rode em qualquer cart&atilde;o inteligente que seja Java Card&semi;</li>&#10;<li>Seguro: al&eacute;m do ambiente de execu&ccedil;&atilde;o seguro herdado de J2SE, Java Card implementa diversas fun&ccedil;&otilde;es criptogr&aacute;ficas, aproveitando as fun&ccedil;&otilde;es dos cart&otilde;es inteligentes como tokens criptogr&aacute;ficos&semi;</li>&#10;<li>&Eacute; Java! Aproveite seus conhecimentos J2SE para desenvolver para cart&otilde;es inteligentes!</li>&#10;<li>Capacidade de m&uacute;ltiplos aplicativos no mesmo cart&atilde;o inteligente: imagine poder ter no mesmo cart&atilde;o servi&ccedil;os dos correios, banco, telefonia, vale&shy;refei&ccedil;&atilde;o, etc. Este tipo de ambiente proposto pela plataforma Java Card oferece isso possibilitando in&uacute;meras oportunidades de neg&oacute;cio&semi;</li>&#10;<li>Din&acirc;mico: &eacute; poss&iacute;vel instalar um novo applet que j&aacute; foi distribu&iacute;do. Imagine que se uma entidade precisar atualizar o servi&ccedil;o no cart&atilde;o de seus clientes, n&atilde;o precisar&aacute; mais enviar o mesmo novamente, na pr&oacute;xima vez que o cart&atilde;o for inserido no terminal, a atualiza&ccedil;&atilde;o ser&aacute; procedida&semi;</li>&#10;<li>Compat&iacute;vel com padr&otilde;es da ind&uacute;stria: toda a framework suporta a norma ISO 7816 que define diversos padr&otilde;es sobre cart&otilde;es inteligentes. Voc&ecirc; tem celular GSM? Java Card suporta padr&otilde;es relacionados a telecomunica&ccedil;&otilde;es tamb&eacute;m de modo que hoje boa parte dos SIM Cards no Brasil s&atilde;o Java Cards.</li></ul>&#10;<a id="Limita%C3%A7%C3%B5es" name="Limita%C3%A7%C3%B5es"></a><h2>Limita&ccedil;&otilde;es</h2>&#10;<p>Segundo Zavadski(2009) uma das primeiras coisas que podemos pensar &eacute; como uma linguagem t&atilde;o poderosa como Java pode executar num hardware t&atilde;o limitado? Claro que se trata de uma vers&atilde;o enxuta de Java, o que conhecemos por subconjunto (subset) da linguagem. Veja abaixo a lista de recursos n&atilde;o suportados:&#10;</p>&#10;<ul>&#10;<li>Carga din&acirc;mica de classes</li>&#10;<li>Security Manager</li>&#10;<li>Finalization</li>&#10;<li>Threads</li>&#10;<li>Cloning</li>&#10;<li>Controle de acesso nos pacotes</li>&#10;<li>Keywords: native, synchronized, transient, volatile, strictfp</li>&#10;<li>Classe: System</li></ul>&#10;<a id="Processo_de_desenvolvimento" name="Processo_de_desenvolvimento"></a><h2>Processo de desenvolvimento</h2>&#10;&#10;<p>Primeiro voc&ecirc; baixa o Sun Java Card Development Kit, prepara o ambiente (veja mais no nas refer&ecirc;ncias no final do artigo) ent&atilde;o voc&ecirc;:</p>&#10;&#10;<ol>&#10;<li>Escreve o .java normalmente no seu editor preferido.</li>&#10;<li>Compila com javac</li>&#10;<li>Converte com a ferramenta Converter (Dispon&iacute;vel no JCRE)</li>&#10;<li>Simula (opcional) com o JCWDE (Dispon&iacute;vel no JCRE) ou C&shy;JRE (Dispon&iacute;vel no JCRE)</li>&#10;<li>Instala no cart&atilde;o inteligente</li></ol>&#10;<a id="Arquivo_CAP" name="Arquivo_CAP"></a><h3>Arquivo CAP</h3>&#10;<p>Em Java Card, o arquivo central n&atilde;o &eacute; o .class mas sim o .cap, resultado da convers&atilde;o de um pacote de .class atrav&eacute;s da ferramenta Converter.</p>&#10;<a id="Java_Card_HelloWorld" name="Java_Card_HelloWorld"></a><h3>Java Card HelloWorld</h3>&#10;<p>Para finalizar, que tal um HelloWorld? Perceba que o exemplo usa valores hexadecimais (bytes) para enviar uma mensagem APDU (Application Protocol Data Unit) e que existem m&eacute;todos como select(), install(), deselect(), process(). Estes m&eacute;todos est&atilde;o relacionados ao ciclo de atividade e vida de um applet.&#10;</p><pre class="code">&#10; <font color="#3F7F5F">/*&#10; * Package:  br.com.igormedeiros&#10; * Filename: HelloWorldJC.java&#10; * Class:    HelloWorldJC&#10; * Date:     [[8 de maio]] de [[2005]] 14:55:52&#10; *&#10; */</font>&#10; &#10; <b><font color="#7F0055">package</font></b> br.com.igormedeiros&semi;&#10; &#10; <b><font color="#7F0055">import</font></b> javacard.framework.*&semi;&#10; &#10; <font color="#3F5FBF">/**&#10; *&#10; * Class HelloWorldJC&#10; *&#10; */</font>&#10; &#10; <b><font color="#7F0055">public</font></b> <b><font color="#7F0055">class</font></b> HelloWorldJC <b><font color="#7F0055">extends</font></b> javacard.framework.Applet {&#10; &#10; <font color="#3F7F5F">// CLA Byte&#10;</font> &#10; <b><font color="#7F0055">final</font></b> <b><font color="#7F0055">static</font></b> <b><font color="#7F0055">byte</font></b> HELLO_CLA = (<b><font color="#7F0055">byte</font></b>) 0xB0&semi;&#10; &#10; <font color="#3F7F5F">// Verify PIN&#10;</font> &#10; <b><font color="#7F0055">final</font></b> <b><font color="#7F0055">static</font></b> <b><font color="#7F0055">byte</font></b> INS_HELLO = (<b><font color="#7F0055">byte</font></b>) 0x20&semi;&#10; &#10; <b><font color="#7F0055">public</font></b> <b><font color="#7F0055">static</font></b> <b><font color="#7F0055">void</font></b> install(<b><font color="#7F0055">byte</font></b>[] bArray, <b><font color="#7F0055">short</font></b> bOffset, <b><font color="#7F0055">byte</font></b> bLength) {&#10; &#10;  (<b><font color="#7F0055">new</font></b> HelloWorldJC()).register(&#10; &#10;   bArray,&#10; &#10;   (<b><font color="#7F0055">short</font></b>) (bOffset + 1),&#10; &#10;   bArray[bOffset])&semi;&#10; &#10; }&#10; &#10; <font color="#3F7F5F">// processa o comando APDU&#10;</font> &#10; <b><font color="#7F0055">public</font></b> <b><font color="#7F0055">void</font></b> process(APDU apdu) {&#10; &#10;  <b><font color="#7F0055">byte</font></b>[] buffer = apdu.getBuffer()&semi;&#10; &#10;  <b><font color="#7F0055">if</font></b> ((buffer[ISO7816.OFFSET_CLA] == 0)&#10; &#10;   &#38&semi;&#38&semi; (buffer[ISO7816.OFFSET_INS] == (<b><font color="#7F0055">byte</font></b>) (0xA4)))&#10; &#10;   <b><font color="#7F0055">return</font></b>&semi;&#10; &#10;  <font color="#3F7F5F">// Validate the CLA byte&#10;</font> &#10;  <b><font color="#7F0055">if</font></b> (buffer[ISO7816.OFFSET_CLA] != HELLO_CLA)&#10; &#10;   ISOException.throwIt(ISO7816.SW_CLA_NOT_SUPPORTED)&semi;&#10; &#10;  <font color="#3F7F5F">// Select the apropriate instruction (Byte INS)&#10;</font> &#10;  <b><font color="#7F0055">switch</font></b> (buffer[ISO7816.OFFSET_INS]) {&#10; &#10;   <b><font color="#7F0055">case</font></b> INS_HELLO :&#10; &#10;    getHello(apdu)&semi;&#10; &#10;    <b><font color="#7F0055">return</font></b>&semi;&#10; &#10;   <b><font color="#7F0055">default</font></b> :&#10; &#10;    ISOException.throwIt(ISO7816.SW_INS_NOT_SUPPORTED)&semi;&#10; &#10;  }&#10; &#10; }&#10; &#10; <font color="#3F5FBF">/**&#10; &#10;  * @param apdu&#10; &#10;  * @author Igor Medeiros&#10; &#10;  * Get user id attribute&#10; &#10;  */</font>&#10; &#10; <b><font color="#7F0055">private</font></b> <b><font color="#7F0055">void</font></b> getHello(APDU apdu) {&#10; &#10;  <font color="#3F7F5F">// cadeia de bytes com a mensagem: &#34&semi;hello world Java Card&#34&semi;&#10;</font> &#10;  <b><font color="#7F0055">byte</font></b>[] hello =&#10; &#10;   {&#10; &#10;    <font color="#2A00FF">&#39&semi;h&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;e&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;l&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;l&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;o&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi; &#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;w&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;o&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;r&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;l&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;d&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi; &#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;J&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;a&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;v&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;a&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi; &#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;C&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;a&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;r&#39&semi;</font>,&#10; &#10;    <font color="#2A00FF">&#39&semi;d&#39&semi;</font> }&semi;&#10; &#10;  <font color="#3F7F5F">// informa ao JCRE que ser&aacute; enviado uma resposta&#10;</font> &#10;  <b><font color="#7F0055">short</font></b> le = apdu.setOutgoing()&semi;&#10; &#10;  <b><font color="#7F0055">short</font></b> totalBytes = (<b><font color="#7F0055">short</font></b>) hello.length&semi;&#10; &#10;  <font color="#3F7F5F">// informa ao JCRE o tamanho da mensagem em bytes&#10;</font> &#10;  apdu.setOutgoingLength(totalBytes)&semi;&#10; &#10;  <font color="#3F7F5F">// envia a mensgem para o host&#10;</font> &#10;  apdu.sendBytesLong(hello, (<b><font color="#7F0055">short</font></b>) 0, (<b><font color="#7F0055">short</font></b>) hello.length)&semi;&#10; &#10;  }&#10; &#10; }&#10;</pre>&#10;<p><b>Testando</b></p>&#10;<p>Ap&oacute;s enviar comando de select, envie o seguinte comando:&#10;B0 20 00 00</p>&#10;<p>A sa&iacute;da ser&aacute;:&#10;68 65 6C 6C 6F 20 77 6F 72 6C 64 20 4A 61 76 61 20 43 61 72 64 90 00</p>&#10;<a id="%7B%7BLiga%C3%A7%C3%B5es_externas%7D%7D" name="%7B%7BLiga%C3%A7%C3%B5es_externas%7D%7D"></a><h2> </h2>&#10;&#10;<ul>&#10;<li><a class="externallink" href="http://java.sun.com/products/javacard/specs.html" rel="nofollow" title="http://java.sun.com/products/javacard/specs.html">Java Card Platform Specification (Sun Microsystems)</a></li>&#10;<li><a class="externallink" href="http://softtecharticles.com/mambo/content/view/45/53/" rel="nofollow" title="http://softtecharticles.com/mambo/content/view/45/53/">Smart Card Basics</a></li></ul>&#10;<p> </p>&#10;<p><a href="http://en.wikipedia.org/wiki/Categoria:Plataforma_Java" id="w">Categoria:Plataforma Java</a></p></body></html>