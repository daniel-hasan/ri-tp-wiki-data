<html><title>Ext2</title><body>&#10;<p> </p>&#10;<p>O <b>Ext2</b> (<i>Second Extended file system</i>) &eacute; um <a href="http://en.wikipedia.org/wiki/Sistema_de_ficheiros" id="w">sistema de arquivos</a> para dispositivos de blocos (disco r&iacute;gido, disquete, <i>pen drive</i>). Foi desenvolvido para o <a href="http://en.wikipedia.org/wiki/Linux_(n%C3%BAcleo)" id="w">Linux</a> por <a href="http://en.wikipedia.org/wiki/R%C3%A9my_Card" id="w">R&eacute;my Card</a> para substituir o <a href="http://en.wikipedia.org/wiki/Ext" id="w">Ext</a> (<i>Extended file system</i>), que tamb&eacute;m havia sido criado por R&eacute;my Card. </p>&#10;<a id="Hist%C3%B3ria" name="Hist%C3%B3ria"></a><h2>Hist&oacute;ria</h2>&#10;&#10;<p>Esta se&ccedil;&atilde;o &eacute; baseada no texto de Card, Ts&#39&semi;o e Tweedie [1994].</p>&#10;<p>Linus Torvalds adaptou o sistema de arquivos do <a href="http://en.wikipedia.org/wiki/MINIX" id="w">MINIX</a>, de <a href="http://en.wikipedia.org/wiki/Andrew_Tanenbaum" id="w">Andrew Tanenbaum</a>, para o Linux. Entretanto, aquele sistema tinha v&aacute;rias limita&ccedil;&otilde;es, como o tamanho do volume suportado (m&aacute;ximo de 64 MiB) e nome de arquivos (at&eacute; 14 caracteres).</p>&#10;<p>Ap&oacute;s a inclus&atilde;o do <a href="http://en.wikipedia.org/wiki/VFS" id="w">VFS</a> (<i>Virtual Filesystem</i>) no n&uacute;cleo inicialmente escrito por Chris Provenzano, depois reescrito por Torvalds, R&eacute;my Card criou o Ext em 1992, que foi inclu&iacute;do no <a href="http://en.wikipedia.org/wiki/Linux_(n%C3%BAcleo)" id="w">Linux</a> 0.96c. Esse sistema de arquivos estendeu o limite do volume para 2 GiB e o tamanho do nome de arquivo para 255 caracteres.</p>&#10;<p>O Ext ainda tinha alguns problemas, como a falta de suporte a modifica&ccedil;&atilde;o em n&oacute;s&shy;i e no tempo de modifica&ccedil;&atilde;o do arquivo. E com o uso, o sistema ficava fragmentado e lento. No in&iacute;cio de 1993 foram disponibilizados 2 novos sistemas: o XiaFS, de Frank Xia, tamb&eacute;m baseado no Minix&semi; e o Ext2, que tornou&shy;se o sistema de arquivos padr&atilde;o para instala&ccedil;&otilde;es Linux.</p>&#10;<a id="Caracter%C3%ADsticas_t%C3%A9cnicas" name="Caracter%C3%ADsticas_t%C3%A9cnicas"></a><h2>Caracter&iacute;sticas t&eacute;cnicas</h2>&#10;&#10;<p>Ext2 foi projetado e implementado para corrigir as defici&ecirc;ncias do Ext e prover um sistema que respeitasse a sem&acirc;ntica UNIX. A influ&ecirc;ncia do UNIX pode ser vista, por exemplo, na utiliza&ccedil;&atilde;o de grupos de blocos, que s&atilde;o an&aacute;logos aos grupos de cilindros utilizados pelo FFS [CARD, TS&#39&semi;O &#38&semi; TWEEDIE, 1994]. A vers&atilde;o original do FFS originou o que &eacute; hoje conhecido como UFS1 (Unix File System 1) [MCKUSIC &#38&semi; NEVILLE&shy;NEIL, 2005].</p>&#10;<p>O bloco, que consiste num conjunto de setores (cada setor tem 512 bytes), &eacute; a menor unidade de aloca&ccedil;&atilde;o para o Ext2. O tamanho pode ser de 1024, 2048 ou 4096 bytes e &eacute; definido na formata&ccedil;&atilde;o. [BOVET e CESATI, 2005, p.&#160&semi;739]. </p>&#10;<p>O tamanho m&aacute;ximo de um volume Ext2 &eacute; de 8 TiB [MINGMING CAO <i>et al</i>, 2005]. Embora o superbloco (v. abaixo) contenha um campo de 32 bits que determina o n&uacute;mero de blocos (<tt>s_blocks_count</tt>), o que permitiria armazenar at&eacute; 16 TiB, o tamanho &eacute; limitado pelo n&uacute;mero de grupos de bloco, que &eacute; de 65 536 (determinado pelo campo <tt>s_block_group_nr</tt>), pois o campo ocupa dois bytes (16 bits). Assim, caso o volume seja formatado usando blocos de 4 KiB, cada grupo de blocos tem at&eacute; 32 768 blocos&semi; com 65 536 blocos obt&eacute;m&shy;se o limite indicado (4 KiB * 32 768 * 65 536 = 8 589 934 592 KiB = 8 TiB).</p>&#10;<p>As subse&ccedil;&otilde;es a seguir descrevem, resumidamente, as estruturas do Ext2 (superbloco, n&oacute;&shy;i, grupos de blocos, mapas de bits de blocos e de n&oacute;s&shy;i e tabelas de n&oacute;s&shy;i), que s&atilde;o mostradas com mais profundidade e detalhamento por Carrier [2005, pp.&#160&semi;449&ndash;460], Bovet &#38&semi; Cesati [2005, pp.&#160&semi;741&ndash;746] e, principalmente, no c&oacute;digo fonte do Linux&mdash;neste texto foi usado como refer&ecirc;ncia a vers&atilde;o 2.6.28.8 (de mar&ccedil;o de 2009) [TORVALDS <i>et al</i>, 2009].</p>&#10;<a id="Superbloco" name="Superbloco"></a><h3>Superbloco</h3>&#10;&#10;<p>O superbloco &eacute; a estrutura b&aacute;sica do Ext2. Ocupa 1024 bytes e inicia no terceiro setor do volume.</p>&#10;&#10;<div style="page&shy;break&shy;inside:&#9;avoid&semi;">&#10;<table align="center" border="1">&#10;<tr>&#10;<td align="center">Bytes </td>&#10;<td align="center">Campo </td>&#10;<td align="center">Descri&ccedil;&atilde;o </td>&#10;<td align="center">Bytes </td>&#10;<td align="center">Campo </td>&#10;<td align="center">Descri&ccedil;&atilde;o </td></tr>&#10;<tr>&#10;<td align="right">0&shy;3 </td>&#10;<td align="left">s_inodes_count </td>&#10;<td align="left">N&uacute;mero de n&oacute;s&shy;i </td>&#10;<td align="right">68&shy;71 </td>&#10;<td align="left">s_checkinterval </td>&#10;<td align="left">Intervalo entre verifica&ccedil;&otilde;es</td></tr>&#10;<tr>&#10;<td align="right">4&shy;7 </td>&#10;<td align="left">s_blocks_count </td>&#10;<td align="left">N&uacute;mero de blocos </td>&#10;<td align="right">72&shy;75 </td>&#10;<td align="left">s_creator_os </td>&#10;<td align="left">Criador (SO)</td></tr>&#10;<tr>&#10;<td align="right">8&shy;11 </td>&#10;<td align="left">s_r_blocks_count </td>&#10;<td align="left">N&uacute;mero de blocos reservados </td>&#10;<td align="right">76&shy;79 </td>&#10;<td align="left">s_rev_level </td>&#10;<td align="left">Vers&atilde;o maior</td></tr>&#10;<tr>&#10;<td align="right">12&shy;15 </td>&#10;<td align="left">s_free_blocks_count </td>&#10;<td align="left">N&uacute;mero de blocos n&atilde;o alocados </td>&#10;<td align="right">80&shy;81 </td>&#10;<td align="left">s_def_resuid </td>&#10;<td align="left">UID do dono dos blocos reservados</td></tr>&#10;<tr>&#10;<td align="right">16&shy;19 </td>&#10;<td align="left">s_free_inodes_count </td>&#10;<td align="left">N&uacute;mero de n&oacute;s&shy;i n&atilde;o alocados </td>&#10;<td align="right">82&shy;83 </td>&#10;<td align="left">s_def_resgid </td>&#10;<td align="left">GID do dono dos blocos reservados</td></tr>&#10;<tr>&#10;<td align="right">20&shy;23 </td>&#10;<td align="left">s_first_data_block </td>&#10;<td align="left">Primeiro bloco do grupo 0 </td>&#10;<td align="right">84&shy;87 </td>&#10;<td align="left">s_first_ino </td>&#10;<td align="left">Primeiro n&oacute;&shy;i n&atilde;o reservado</td></tr>&#10;<tr>&#10;<td align="right">24&shy;27 </td>&#10;<td align="left">s_log_block_size </td>&#10;<td align="left">Tamanho do bloco </td>&#10;<td align="right">88&shy;89 </td>&#10;<td align="left">s_inode_size </td>&#10;<td align="left">Tamanho do n&oacute;&shy;i</td></tr>&#10;<tr>&#10;<td align="right">28&shy;31 </td>&#10;<td align="left">s_log_frag_size </td>&#10;<td align="left">Tamanho do fragmento </td>&#10;<td align="right">90&shy;91 </td>&#10;<td align="left">s_block_group_nr </td>&#10;<td align="left">N&uacute;mero deste grupo de blocos [1]</td></tr>&#10;<tr>&#10;<td align="right">32&shy;35 </td>&#10;<td align="left">s_blocks_per_group </td>&#10;<td align="left">N&uacute;mero de blocos por grupo </td>&#10;<td align="right">92&shy;95 </td>&#10;<td align="left">s_feature_compat </td>&#10;<td align="left">Sinalizadores de compatibilidade</td></tr>&#10;<tr>&#10;<td align="right">36&shy;39 </td>&#10;<td align="left">s_frags_per_group </td>&#10;<td align="left">N&uacute;mero de fragmentos por grupo </td>&#10;<td align="right">96&shy;99 </td>&#10;<td align="left">s_feature_incompat </td>&#10;<td align="left">Sinalizadores de incompatibilidade</td></tr>&#10;<tr>&#10;<td align="right">40&shy;43 </td>&#10;<td align="left">s_inodes_per_group </td>&#10;<td align="left">N&uacute;mero de n&oacute;s&shy;i por grupo </td>&#10;<td align="right">100&shy;103 </td>&#10;<td align="left">s_feature_ro_compat </td>&#10;<td align="left">Indicadores de somente leitura</td></tr>&#10;<tr>&#10;<td align="right">44&shy;47 </td>&#10;<td align="left">s_mtime </td>&#10;<td align="left">Tempo da &uacute;ltima montagem </td>&#10;<td align="right">104&shy;119 </td>&#10;<td align="left">s_uuid </td>&#10;<td align="left">ID do sistema de arquivos</td></tr>&#10;<tr>&#10;<td align="right">48&shy;51 </td>&#10;<td align="left">s_wtime </td>&#10;<td align="left">Tempo da &uacute;ltima altera&ccedil;&atilde;o </td>&#10;<td align="right">120&shy;135 </td>&#10;<td align="left">s_volume_name </td>&#10;<td align="left">Nome do volume</td></tr>&#10;<tr>&#10;<td align="right">52&shy;53 </td>&#10;<td align="left">s_mnt_count </td>&#10;<td align="left">Contador de montagens </td>&#10;<td align="right">136&shy;199 </td>&#10;<td align="left">s_last_mounted </td>&#10;<td align="left">Caminho da &uacute;ltima montagem</td></tr>&#10;<tr>&#10;<td align="right">54&shy;55 </td>&#10;<td align="left">s_max_mnt_count </td>&#10;<td align="left">N&uacute;mero m&aacute;ximo de montagens </td>&#10;<td align="right">200&shy;203 </td>&#10;<td align="left">s_algorithm_usage_bitmap </td>&#10;<td align="left">Algoritmo de uso de mapa de bits</td></tr>&#10;<tr>&#10;<td align="right">56&shy;57 </td>&#10;<td align="left">s_magic </td>&#10;<td align="left">Assinatura (0xef53) </td>&#10;<td align="right">204 </td>&#10;<td align="left">s_prealloc_blocks </td>&#10;<td align="left">N&uacute;mero de blocos pr&eacute;&shy;alocados para arquivos</td></tr>&#10;<tr>&#10;<td align="right">58&shy;59 </td>&#10;<td align="left">s_state </td>&#10;<td align="left">Estado do sistema de arquivos </td>&#10;<td align="right">205 </td>&#10;<td align="left">s_prealloc_dir_blocks </td>&#10;<td align="left">N&uacute;mero de blocos pr&eacute;&shy;alocados para diret&oacute;rios</td></tr>&#10;<tr>&#10;<td align="right">60&shy;61 </td>&#10;<td align="left">s_errors </td>&#10;<td align="left">M&eacute;todo de manipula&ccedil;&atilde;o de erros </td>&#10;<td align="right">206&shy;231 </td>&#10;<td align="left" />&#10;<td align="left">Sem uso para Ext2</td></tr>&#10;<tr>&#10;<td align="right">62&shy;63 </td>&#10;<td align="left">s_minor_rev_level </td>&#10;<td align="left">Vers&atilde;o menor </td>&#10;<td align="right">232&shy;235 </td>&#10;<td align="left">s_last_orphan </td>&#10;<td align="left">Cabe&ccedil;alho da lista de n&oacute;s&shy;i &oacute;rf&atilde;os</td></tr>&#10;<tr>&#10;<td align="right">64&shy;67 </td>&#10;<td align="left">s_lastcheck </td>&#10;<td align="left">Tempo da &uacute;ltima verifica&ccedil;&atilde;o </td>&#10;<td align="right">236&shy;1023 </td>&#10;<td align="left" />&#10;<td align="left">Sem uso</td></tr></table></div>&#10;<p><center><i>Estrutura do superbloco [TORVALDS </i>et al<i>, 2009].</i></center></p>&#10;<p><small>Observa&ccedil;&otilde;es sobre a tabela:</small></p>&#10;<p>[1] O superbloco possui c&oacute;pia(s) espalhadas no volume, e este n&uacute;mero identifica o grupo de blocos em que o superbloco est&aacute; contido.</p>&#10;<a id="N%C3%B3&shy;i" name="N%C3%B3&shy;i"></a><h3>N&oacute;&shy;i</h3>&#10;&#10;<p>Um arquivo &eacute; descrito (a menos do seu nome e seu diret&oacute;rio pai) por um n&oacute;&shy;i (<i>inode</i> ou <i>index node</i>). O n&oacute;&shy;i &eacute; uma estrutura de dados com tamanho padr&atilde;o de 128 bytes. O tamanho &eacute; definido na formata&ccedil;&atilde;o (<tt>mke2fs &shy;I <i>tamanho</i></tt>). Alguns par&acirc;metros s&atilde;o obrigat&oacute;rios (ou essenciais), como as permiss&otilde;es, o tamanho do arquivo e o endere&ccedil;amento dos blocos alocados. Outros, embora &uacute;teis e quase sempre definidos, s&atilde;o opcionais, como o UID, GID, r&oacute;tulos de tempo, etc. A tabela seguinte mostra sua estrutura.</p>&#10;&#10;<div style="page&shy;break&shy;inside:&#9;avoid&semi;">&#10;<table align="center" border="1">&#10;<tr>&#10;<td align="center">Bytes </td>&#10;<td align="center">Campo </td>&#10;<td align="center">Descri&ccedil;&atilde;o </td>&#10;<td align="center">Bytes </td>&#10;<td align="center">Campo </td>&#10;<td align="center">Descri&ccedil;&atilde;o </td></tr>&#10;<tr>&#10;<td align="right">0&shy;1 </td>&#10;<td align="left">i_mode </td>&#10;<td align="left">Permiss&otilde;es e atributos [1] </td>&#10;<td align="right">40&shy;87 </td>&#10;<td align="left">i_block </td>&#10;<td align="left">12 endere&ccedil;os de blocos</td></tr>&#10;<tr>&#10;<td align="right">2&shy;3 </td>&#10;<td align="left">i_uid </td>&#10;<td align="left">UID: 16 bits menos significativos </td>&#10;<td align="right">88&shy;91 </td>&#10;<td align="left">i_block </td>&#10;<td align="left">Um endere&ccedil;o de bloco indireto simples</td></tr>&#10;<tr>&#10;<td align="right">4&shy;7 </td>&#10;<td align="left">i_size </td>&#10;<td align="left">Tamanho do arquivo [2] </td>&#10;<td align="right">92&shy;95 </td>&#10;<td align="left">i_block </td>&#10;<td align="left">Um endere&ccedil;o de bloco indireto duplo</td></tr>&#10;<tr>&#10;<td align="right">8&shy;11 </td>&#10;<td align="left">i_atime </td>&#10;<td align="left">&Uacute;ltimo acesso ao arquivo </td>&#10;<td align="right">96&shy;99 </td>&#10;<td align="left">i_block </td>&#10;<td align="left">Um endere&ccedil;o de bloco indireto triplo</td></tr>&#10;<tr>&#10;<td align="right">12&shy;15 </td>&#10;<td align="left">i_ctime </td>&#10;<td align="left">&Uacute;ltima modifica&ccedil;&atilde;o do n&oacute;&shy;i </td>&#10;<td align="right">100&shy;103 </td>&#10;<td align="left">i_generation </td>&#10;<td align="left">N&uacute;mero de gera&ccedil;&atilde;o (NFS)</td></tr>&#10;<tr>&#10;<td align="right">16&shy;19 </td>&#10;<td align="left">i_mtime </td>&#10;<td align="left">&Uacute;ltima modifica&ccedil;&atilde;o do arquivo </td>&#10;<td align="right">104&shy;107 </td>&#10;<td align="left">i_file_acl </td>&#10;<td align="left">Atributo estendido (ACL) do arquivo</td></tr>&#10;<tr>&#10;<td align="right">20&shy;23 </td>&#10;<td align="left">i_dtime </td>&#10;<td align="left">Tempo de remo&ccedil;&atilde;o do arquivo </td>&#10;<td align="right">108&shy;111 </td>&#10;<td align="left">i_dir_acl </td>&#10;<td align="left">ACL de diret&oacute;rio ou tamanho de arquivo [3]</td></tr>&#10;<tr>&#10;<td align="right">24&shy;25 </td>&#10;<td align="left">i_gid </td>&#10;<td align="left">GID: 16 bits menos significativos </td>&#10;<td align="right">112&shy;117 </td>&#10;<td align="left">i_faddr </td>&#10;<td align="left">Informa&ccedil;&otilde;es de fragmentos [4] </td></tr>&#10;<tr>&#10;<td align="right">26&shy;27 </td>&#10;<td align="left">i_links_count </td>&#10;<td align="left">Contador de links </td>&#10;<td align="right">118&shy;119 </td>&#10;<td align="left" />&#10;<td align="left">N&atilde;o usado</td></tr>&#10;<tr>&#10;<td align="right">28&shy;31 </td>&#10;<td align="left">i_blocks </td>&#10;<td align="left">Contador de setores </td>&#10;<td align="right">120&shy;121 </td>&#10;<td align="left">l_i_uid_high </td>&#10;<td align="left">UID: 16 bits mais significativos</td></tr>&#10;<tr>&#10;<td align="right">32&shy;35 </td>&#10;<td align="left">i_flags </td>&#10;<td align="left">Sinalizadores </td>&#10;<td align="right">122&shy;123 </td>&#10;<td align="left">l_i_gid_high </td>&#10;<td align="left">GID: 16 bits mais significativos</td></tr>&#10;<tr>&#10;<td align="right">36&shy;39 </td>&#10;<td align="left" />&#10;<td align="left">Reservado </td>&#10;<td align="right">124&shy;127 </td>&#10;<td align="left" />&#10;<td align="left">N&atilde;o usado</td></tr></table></div>&#10;<p><center><i>Estrutura do n&oacute;&shy;i [TORVALDS </i>et al<i>, 2009].</i></center></p>&#10;<p><small>Observa&ccedil;&otilde;es sobre a tabela:</small></p>&#10;<p>[1] Cont&eacute;m sinalizadores (<i>flags</i>) de permiss&atilde;o e tipo: nove bits de permiss&atilde;o &ldquo;rwx&rdquo; &shy; leitura, escrita e execu&ccedil;&atilde;o para o dono, grupo e outros&semi; tr&ecirc;s bits definem o <i>sticky</i> bit, SGID e SUID&semi; quatro bits identificam os tipos de arquivo (regular, diret&oacute;rio, dispositivo, <i>link</i> simb&oacute;lico, etc.). </p>&#10;<p>[2] Se o arquivo tiver menos que 4 GiB&semi; caso contr&aacute;rio, mostra os 32 bits mais significativos do tamanho&mdash;v. [3].</p>&#10;<p>[3] Caso o arquivo tenha 4 GiB ou mais, este campo mostra os 32 bits mais significativos do tamanho&mdash;v. [2].</p>&#10;<p>[4] O Ext2 n&atilde;o usa fragmentos.</p>&#10;<p>O n&oacute;&shy;i cont&eacute;m dois registros para contar o tamanho do arquivo: (i) <tt>i_size</tt>, que mostra o tamanho em bytes (definido por dois campos de 32 bits)&semi; (ii) <tt>i_blocks</tt>, que, apesar do nome, mostra o n&uacute;mero de setores ocupados pelo arquivo. O registro <tt>i_size</tt> permite um valor de 8 EiB ((2<sup>63</sup> &shy; 1) bytes pois, segundo Bovet e Cesati [2005, p.&#160&semi;746], um dos bits n&atilde;o &eacute; usado). O n&uacute;mero m&aacute;ximo de setores definido por <tt>i_blocks</tt> &eacute; 4 294 967 295 (2<sup>32</sup> &shy; 1)&semi; como um setor tem 512 bytes, o valor suportado &eacute; de 2 TiB. Portanto, o Ext2 suporta arquivos com, no m&aacute;ximo, 2 TiB de tamanho.</p>&#10;<p>S&atilde;o usados 48 bytes para o endere&ccedil;amento direto de 12 blocos. Caso o arquivo ocupe mais espa&ccedil;o, os quatro bytes seguintes do n&oacute;&shy;i endere&ccedil;am um bloco indireto simples, que cont&eacute;m endere&ccedil;os de blocos de dados&semi; se ainda n&atilde;o for suficiente, mais quatro bytes identificam um bloco indireto duplo (o qual endere&ccedil;a blocos indiretos simples)&semi; finalmente, quatro bytes apontam para um bloco indireto triplo (que endere&ccedil;a blocos indiretos duplos). Nesse esquema, usando&shy;se blocos de 4 KiB, podem&shy;se alocar mais de 4 TiB para um arquivo, embora o limite para o tamanho do arquivo seja menor, como visto anteriormente.</p>&#10;<p>Existem quatro campos (<tt>i_atime, i_ctime, i_mtime, i_dtime</tt>), cada um com 32 bits, para contar o tempo em segundos, a partir de 00:00:00 de primeiro de janeiro de 1970. Os quatro tempos marcados s&atilde;o: <i>access time &ndash; atime</i> (marca o &uacute;ltimo acesso ao arquivo)&semi; <i>change time &ndash; ctime</i> (tempo de altera&ccedil;&atilde;o do n&oacute;&shy;i)&semi; <i>modification time &ndash; mtime</i> (tempo de modifica&ccedil;&atilde;o do arquivo)&semi; <i>deletion time</i> (marca quando o arquivo foi apagado, enquanto o n&oacute;&shy;i n&atilde;o for reaproveitado).</p>&#10;<a id="Grupos_de_blocos" name="Grupos_de_blocos"></a><h3>Grupos de blocos</h3>&#10;&#10;<p>Um volume (parti&ccedil;&atilde;o ou unidade l&oacute;gica) Ext2 &eacute; dividido em grupos de blocos de mesmo tamanho (&agrave; exce&ccedil;&atilde;o do &uacute;ltimo, que pode ser menor). Com um tamanho de bloco de 4 KiB, um grupo cont&eacute;m 32 768 blocos.</p>&#10;<p>Cada grupo de blocos possui uma tabela de descritores que endere&ccedil;am os mapas de bits dos blocos e dos n&oacute;s&shy;i e a tabela de n&oacute;s&shy;i. O primeiro grupo cont&eacute;m o superbloco, que possui c&oacute;pia em alguns outros grupos. No mapa de bits de blocos, cada byte mapeia 8 blocos (um por bit). O bit menos significativo identifica o bloco de menor n&uacute;mero. O mapa de bits de n&oacute;s&shy;i &eacute; an&aacute;logo.</p>&#10;<a id="Mapa_de_bits_de_blocos" name="Mapa_de_bits_de_blocos"></a><h4>Mapa de bits de blocos</h4>&#10;&#10;<p>Um mapa de bits de bloco &eacute; usado para mostrar quais os blocos que, dentro do grupo, est&atilde;o livres ou alocados. Quando o tamanho de bloco &eacute; de 4 KiB, podem ser mostrados 32 768 blocos (4096 * 8). Um bit &#34&semi;1&#34&semi; indica que o bloco correspondente est&aacute; alocado e um bit &#34&semi;0&#34&semi; indica que o bloco est&aacute; livre. O primeiro byte do bloco mostra os primeiros 8 blocos do grupo&semi; o bit menos significativo mostra o primeiro bloco e o bit mais significativo mostra o oitavo bloco.</p>&#10;<a id="Mapa_de_bits_de_n%C3%B3s&shy;i" name="Mapa_de_bits_de_n%C3%B3s&shy;i"></a><h4>Mapa de bits de n&oacute;s&shy;i</h4>&#10;&#10;<p>Um mapa de bits de n&oacute;s&shy;i &eacute; usado para indicar a aloca&ccedil;&atilde;o de n&oacute;s&shy;i, de modo an&aacute;logo &agrave; aloca&ccedil;&atilde;o de blocos vista anteriormente. Como o n&uacute;mero de n&oacute;s&shy;i &eacute;, geralmente, menor que o n&uacute;mero de blocos, somente uma parte do bloco &eacute; usada.</p>&#10;<a id="Tabela_de_n%C3%B3s&shy;i" name="Tabela_de_n%C3%B3s&shy;i"></a><h4>Tabela de n&oacute;s&shy;i</h4>&#10;&#10;<p>A tabela de n&oacute;s&shy;i &eacute; formada por blocos consecutivos ap&oacute;s os mapas de bits. Cada entrada na tabela &eacute; um n&oacute;&shy;i&semi; assim, um bloco de 4 KiB pode conter at&eacute; 32 n&oacute;s&shy;i.</p>&#10;<a id="Aloca%C3%A7%C3%A3o_de_blocos" name="Aloca%C3%A7%C3%A3o_de_blocos"></a><h3>Aloca&ccedil;&atilde;o de blocos</h3>&#10;&#10;<p>Quando &eacute; realizada uma opera&ccedil;&atilde;o de escrita em um arquivo, o Ext2 tenta, sempre que poss&iacute;vel, alocar blocos de dados no mesmo grupo que cont&eacute;m o n&oacute;&shy;i. Esse comportamento reduz o movimento da(s) cabe&ccedil;a(s) de leitura&shy;grava&ccedil;&atilde;o da unidade de disco.</p>&#10;<p>Em um sistema de arquivos ocorrem dois tipos de fragmenta&ccedil;&atilde;o: (i) a fragmenta&ccedil;&atilde;o interna (ou de espa&ccedil;o) &eacute; causada pelo fato do tamanho do arquivo geralmente n&atilde;o ser m&uacute;ltiplo do tamanho do bloco (portanto o &uacute;ltimo bloco ter&aacute; um espa&ccedil;o n&atilde;o utilizado) &shy;&shy; a consequ&ecirc;ncia &eacute; a perda de espa&ccedil;o&semi; (ii) a fragmenta&ccedil;&atilde;o externa (ou de arquivo) decorre da impossibilidade do sistema determinar, <i>a priori</i>, qual o tamanho do arquivo (p.ex., arquivos de texto e de <i>logs</i> s&atilde;o muito modificados, e o seu tamanho pode aumentar ou diminuir) &shy;&shy; assim um arquivo pode alocar blocos n&atilde;o cont&iacute;guos, prejudicando o desempenho.</p>&#10;<p>Para diminuir o impacto do primeiro tipo, existem duas estrat&eacute;gias b&aacute;sicas. A primeira, mais simples, &eacute; determinar, na formata&ccedil;&atilde;o, o menor tamanho de bloco poss&iacute;vel. O Ext2 permite tamanhos de blocos de 1024, 2048 e 4096 bytes. Um tamanho de bloco pequeno, como 1024 bytes, diminui a fragmenta&ccedil;&atilde;o e perda de espa&ccedil;o, mas em contrapartida gera um impacto negativo no desempenho, pois acarreta o gerenciamento de uma maior quantidade de blocos. O tamanho de bloco padr&atilde;o para volumes grandes &eacute; de 4096 bytes.</p>&#10;<p>A segunda estrat&eacute;gia &eacute; alocar a parte final de um arquivo, menor que o tamanho de um bloco, juntamente com peda&ccedil;os de outros arquivos. O <a href="http://en.wikipedia.org/wiki/Reiserfs" id="w">Reiserfs</a> chama esse m&eacute;todo de <i>tail packing</i>&semi; o UFS usa fragmentos, que s&atilde;o subm&uacute;ltiplos do tamanho do bloco. Apesar do Ext2 possuir, no superbloco, a previs&atilde;o para uso de fragmentos, esse m&eacute;todo n&atilde;o  foi implementado.</p>&#10;<p>Para diminuir o impacto da fragmenta&ccedil;&atilde;o externa, o Ext2 pr&eacute;&shy;aloca (reserva) at&eacute; oito blocos quando um arquivo &eacute; aberto para grava&ccedil;&atilde;o. Esses blocos reservados, quando poss&iacute;vel, s&atilde;o adjacentes ao &uacute;ltimo bloco utilizado pelo arquivo. [CARD, TS&#39&semi;O e TWEEDIE, 1994]</p>&#10;<a id="%7B%7BVer_tamb%C3%A9m%7D%7D" name="%7B%7BVer_tamb%C3%A9m%7D%7D"></a><h2> </h2>&#10;&#10;<ul>&#10;<li><a href="http://en.wikipedia.org/wiki/Ext3" id="w">Ext3</a></li>&#10;<li><a href="http://en.wikipedia.org/wiki/Ext4" id="w">Ext4</a></li></ul>&#10;<a id="Refer%C3%AAncias" name="Refer%C3%AAncias"></a><h2>Refer&ecirc;ncias</h2>&#10;&#10;&#10;<ol>&#10;<li>BOVET, Daniel P.&semi; CESATI, Marco. <b>Understanding the Linux kernel</b>. 3.ed. Sebastopol: O&#39&semi;Reilly. 2005. </li>&#10;<li>CARD, R&eacute;my&semi; TS&#39&semi;O, Theodore&semi; TWEEDIE, Stephen. <b>Design and implementation of the Second Extended Filesystem</b>. <i>Proceedings of the First Dutch International Symposium on Linux</i>. 1994. Dispon&iacute;vel em &#60&semi;<a class="externallink" href="http://web.mit.edu/tytso/www/linux/ext2intro.html" rel="nofollow" title="http://web.mit.edu/tytso/www/linux/ext2intro.html">http://web.mit.edu/tytso/www/linux/ext2intro.html</a>&#62&semi;. Acessado em 01 out. 2007.</li>&#10;<li>CARRIER, Brian. <b>File system forensic analysis</b>. Upper Saddle River: Addison&shy;Wesley. 2005.</li>&#10;<li>TORVALDS, Linus <i>et al</i>. <b> Linux kernel v. 2.6.28.8</b>: <i>include/linux/ext2_fs.h</i>. The Linux Kernel Archives. 2009. Dispon&iacute;vel em &#60&semi;<a class="externallink" href="http://www.kernel.org/pub/linux/kernel/v2.6/" rel="nofollow" title="http://www.kernel.org/pub/linux/kernel/v2.6/">http://www.kernel.org/pub/linux/kernel/v2.6/</a>&#62&semi;. Acesso em 19 mar. 2009.</li>&#10;<li>MCKUSIC, Marshall K.&semi; NEVILLE&shy;NEIL, George V. The design and implementation of the FreeBSD operating system. Upper Saddle River: Addison&shy;Wesley, 2005.</li>&#10;<li>MINGMING CAO <i>et al</i>. <b>State of the art</b>: <i>where we are with the Ext3 filesystem</i>. <i>Ottawa Linux Symposium</i>. 2005. v. 1, pp.&#160&semi;69&ndash;96 Dispon&iacute;vel em &#60&semi;<a class="externallink" href="http://www.linuxsymposium.org/2005/" rel="nofollow" title="http://www.linuxsymposium.org/2005/">http://www.linuxsymposium.org/2005/</a>&#62&semi; Acessado em 28 dez. 2008.</li>&#10;<li>TS&#39&semi;O, Theodore&semi; TWEEDIE, Stephen. <b>Planned extensions to the Linux Ext2/Ext3 Filesystem</b>. <i>USENIX 2002 Annual Technical Conference</i>. [2002]. Dispon&iacute;vel em &#60&semi;<a class="externallink" href="http://www.usenix.org/publications/library/proceedings/usenix02/tech/freenix/full_papers/tso/tso.pdf" rel="nofollow" title="http://www.usenix.org/publications/library/proceedings/usenix02/tech/freenix/full_papers/tso/tso.pdf">http://www.usenix.org/publications/library/proceedings/usenix02/tech/freenix/full_papers/tso/tso.pdf</a>&#62&semi;. Acessado em 17 dez. 2009.</li></ol>&#10;<p> </p>&#10;<p><a href="http://en.wikipedia.org/wiki/Categoria:Sistemas_de_ficheiros" id="w">Categoria:Sistemas de ficheiros</a>&#10;<a href="http://en.wikipedia.org/wiki/Categoria:Linux" id="w">Categoria:Linux</a></p></body></html>